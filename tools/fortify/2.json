[{"Category":"Path Manipulation","Folder":"Critical","Kingdom":"Input Validation and Representation","Abstract":"Attackers are able to control the file system path argument to file_get_contents() at index.php line 11, which allows them to access or modify otherwise protected files.","Friority":"Critical","Primary":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"11\",\"Snippet\":\"    file_put_contents($inputPath, json_encode([]));\\n}\\n$list = json_decode(file_get_contents($inputPath), true);\\n\\n\\\/\\\/\\u5f00\\u59cb\\u6267\\u884c\\u4ee3\\u7801\",\"TargetFunction\":\"file_get_contents()\"}","Source":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"3\",\"Snippet\":\"<?php\\n\\\/\\\/\\u83b7\\u53d6\\u8f93\\u5165\\u7684\\u53c2\\u6570\\n$inputPath = \\\"\\\/data\\\/share\\\/input_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n$outputPath = \\\"\\\/data\\\/share\\\/output_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n\\\/\\\/$inputPath = \\\"1.json\\\";\",\"TargetFunction\":\"getenv()\"}"},{"Category":"Path Manipulation","Folder":"Critical","Kingdom":"Input Validation and Representation","Abstract":"Attackers are able to control the file system path argument to file_put_contents() at index.php line 9, which allows them to access or modify otherwise protected files.","Friority":"Critical","Primary":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"9\",\"Snippet\":\"if (!file_exists($inputPath)) {\\n    print_r(\\\"\\u672a\\u627e\\u5230\\u5fc5\\u8981\\u7684\\u53c2\\u6570\\u6587\\u4ef6:{$inputPath}\\\");\\n    file_put_contents($inputPath, json_encode([]));\\n}\\n$list = json_decode(file_get_contents($inputPath), true);\",\"TargetFunction\":\"file_put_contents()\"}","Source":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"3\",\"Snippet\":\"<?php\\n\\\/\\\/\\u83b7\\u53d6\\u8f93\\u5165\\u7684\\u53c2\\u6570\\n$inputPath = \\\"\\\/data\\\/share\\\/input_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n$outputPath = \\\"\\\/data\\\/share\\\/output_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n\\\/\\\/$inputPath = \\\"1.json\\\";\",\"TargetFunction\":\"getenv()\"}"},{"Category":"Path Manipulation","Folder":"Critical","Kingdom":"Input Validation and Representation","Abstract":"Attackers are able to control the file system path argument to file_put_contents() at index.php line 30, which allows them to access or modify otherwise protected files.","Friority":"Critical","Primary":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"30\",\"Snippet\":\"\\n\\\/\\\/\\u5c06\\u7ed3\\u679c\\u8f93\\u51fa\\u5230\\u6587\\u4ef6\\nfile_put_contents($outputPath, json_encode($data, JSON_UNESCAPED_UNICODE));\\n\\n\",\"TargetFunction\":\"file_put_contents()\"}","Source":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"4\",\"Snippet\":\"\\\/\\\/\\u83b7\\u53d6\\u8f93\\u5165\\u7684\\u53c2\\u6570\\n$inputPath = \\\"\\\/data\\\/share\\\/input_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n$outputPath = \\\"\\\/data\\\/share\\\/output_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n\\\/\\\/$inputPath = \\\"1.json\\\";\\n\\\/\\\/$outputPath = \\\"2.json\\\";\",\"TargetFunction\":\"getenv()\"}"},{"Category":"Command Injection","Folder":"Low","Kingdom":"Input Validation and Representation","Abstract":"Line 62 in index.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.","Friority":"Low","Primary":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"62\",\"Snippet\":\"    @unlink($filenameJson);\\n    $cmd = \\\"cd $toolPath && .\\\/dismap-0.4-linux-amd64 -u {$url} -j {$filenameJson}\\\";\\n    exec($cmd);\\n\\n    return true;\",\"TargetFunction\":\"exec(0)\"}"},{"Category":"Command Injection","Folder":"Low","Kingdom":"Input Validation and Representation","Abstract":"Line 75 in index.php calls exec() to execute a command. This might allow an attacker to inject malicious commands.","Friority":"Low","Primary":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"75\",\"Snippet\":\"        $cmd = \\\"cd {$dirName} && git clone --depth=1 https:\\\/\\\/gitee.com\\\/songboy\\\/dismap.git dismap && chmod 777 -R *\\\";\\n        echo $cmd . PHP_EOL;\\n        exec($cmd, $ret);\\n        print_r(implode(\\\"\\\\n\\\", $ret));\\n    }\",\"TargetFunction\":\"exec(0)\"}"},{"Category":"System Information Leak: External","Folder":"Low","Kingdom":"Encapsulation","Abstract":"The program might reveal system data or debugging information in index.php with a call to print_r() on line 8. The information revealed by print_r() could help an adversary form a plan of attack.","Friority":"Low","Primary":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"8\",\"Snippet\":\"\\\/\\\/$outputPath = \\\"2.json\\\";\\nif (!file_exists($inputPath)) {\\n    print_r(\\\"\\u672a\\u627e\\u5230\\u5fc5\\u8981\\u7684\\u53c2\\u6570\\u6587\\u4ef6:{$inputPath}\\\");\\n    file_put_contents($inputPath, json_encode([]));\\n}\",\"TargetFunction\":\"print_r()\"}","Source":"{\"FileName\":\"index.php\",\"FilePath\":\"index.php\",\"LineStart\":\"3\",\"Snippet\":\"<?php\\n\\\/\\\/\\u83b7\\u53d6\\u8f93\\u5165\\u7684\\u53c2\\u6570\\n$inputPath = \\\"\\\/data\\\/share\\\/input_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n$outputPath = \\\"\\\/data\\\/share\\\/output_\\\" . getenv(\\\"xflow_node_id\\\") . \\\".json\\\";\\n\\\/\\\/$inputPath = \\\"1.json\\\";\",\"TargetFunction\":\"getenv()\"}"}]